{
    "article": "The negative log-likelihood or cross entropy is the usual training objective of NLP models owing to its versatility and empirical performance. However, training objectives which directly target the performance measure used to evaluate the task have the potential to lead to higher empirical accuracy. For this reason, in this short paper we propose using a multi-constraint structured hinge loss as the training objective of a contemporary namedentity recognition (NER) model. Experimental results over the challenging OntoNotes 5.0 dataset have shown that the proposed objective has been able to achieve an improvement of 0.62 CoNLL score points at a complete parity of testing set-up. Introduction All NLP models utilise a loss function as minimisation objective for model training. Choosing the most appropriate loss function for a particular task can play an important role in the performance of the trained models at test time and in-field. However, almost invariably the utilised loss function is the negative log-likelihood (NLL), also known as cross entropy. This is due to a number of attractive properties of the NLL such as its smoothness and differentiability in large regions of the parameter space. In addition, training with minimum NLL often leads to models of high empirical accuracy. However, this function is not exempt from shortcomings. To name two, 1) the NLL only rewards the probability of the ground-truth class and does not distinguish between the other classes, and 2) it does not impose explicit margins (or ratios) between the probability assigned to the ground-truth class and those assigned to the other classes. For this reason, other differentiable loss functions are regarded as appealing alternatives or complements to the NLL. Amongst them are the hinge loss (Cortes and Vapnik, 1995) and the REINFORCE loss (Williams, 1992; Ranzato et al., 2016) which both attempt to directly optimise the performance measure used to evaluate the model's accuracy (e.g., the Hamming loss, the CoNLL score, the BLEU score etc). Both these losses can be used for the usual classification at token level or for the joint classification of all the tokens in a sentence (i.e., structured prediction) (Tsochantaridis et al., 2005) . Given that targeting the evaluation loss during training may lead to improved performance at test time, in this short paper we explore the use of a structured hinge loss for named-entity recognition (NER). Our main contribution is the introduction of additional constraints between specific labelings aimed at increasing the accuracy of the learned model. Experimental results over a challenging NER dataset (OntoNotes 5.0, which is still far from accuracy saturation) show that the proposed approach has been able to achieve higher accuracy than both the NLL and a conventional structured hinge loss. Related Work In this section we briefly review the main literature on NER architectures and on structural loss functions. For a broader review of deep learning for NER, the reader can refer to (Li et al., 2018) . A current and well-known approach for NER combines a bidirectional LSTM with a CRF output layer to benefit from both their properties in sequential tagging (Huang et al., 2015) . In this approach, the LSTM is used first to process each sentence token-by-token and produce an intermediate representation. Then, the CRF uses the intermediate representation as input to provide the joint prediction of all the labels. Lample et al. (2016) have extended this model with a second, auxiliary LSTM encoding each token character-by-character to also capture the regularities at character level. More recently, Peters et al. (2017; 2018) have proposed tagLM and ELMo to take advantage of the contextualised embeddings provided by pre-trained neural language models. Several other variants have been proposed since, including the Flair embedddings of Akbik et al. (2018) which currently hold the state-of-the-art accuracy over OntoNotes 5.0 (NB: besides a system hat uses gazetteers as extra resources to increase accuracy (Liu et al., 2019) ). However, a bidirectional LSTM-CRF with ELMo embeddings can still be regarded as a very strong baseline for NER and, for this reason, it is used in the rest of this paper. For what concerns alternative training objectives to the negative log-likelihood, Zhang at al. (2016) have proposed training an LSTM additioned with a linear output layer by using an SVM objective. In their model, the parameters of both the LSTM and the output layer have been learned jointly using a combination of sequence-level and frame-level regularised hinge losses. Similarly, Shi et al. (2016) have proposed adding a structural SVM output layer (Tsochantaridis et al., 2005) to an RNN to improve its discriminative capability. In 2012, Gimpel and Smith (2012) have proposed a structured ramp loss that leverages various styles of margins between predicted labelings. Recently, Edunov et al. (2018) have carried out an extensive review of structured loss functions, including hinge losses, cost-weighted likelihoods and reinforcement learning objectives. In a 2015 computer vision paper, Zhang and Piccardi (2015) have proposed adding extra constraints to a structured hinge loss to increase its accuracy in a task of activity segmentation in video. Inspired by that approach, in this paper we explore its application to NER, proposing three original combinations of dedicated constraints and margins. Methodology In this section, we first briefly review the structured hinge loss (3.1) and the utilised scoring function (3.2), and then introduce the proposed approach (3.3). Structured hinge loss Given a token sequence, x = {x 1 . . . x t . . . x T }, we note with y = {y 1 . . . y t . . . y T } a labeling, i.e. a sequence of corresponding labels, one per token. We also assume to have a scoring function, F (x, y; w) or F (x, y) for brevity, which is able to assign a compatibility score to any such (x, y) pair. This function is completely defined by its set of parameters, w, and it is a structured predictor if the score of a labeling is computed jointly rather than independently for each label. Given these assumptions, the goal of a structured hinge loss is simply to ensure that the ground-truth labeling, y g , for a given x is assigned a score larger than that of any other labeling, y = y g , by a chosen margin, K: F (x, y g ) \u2212 F (x, y) \u2265 K \u2200y = y g (1) It is often useful to impose a margin that is the larger the more the labeling differs from the ground truth, and this can be achieved by setting the margin to be the evaluation loss (\"margin rescaling\" (Tsochantaridis et al., 2005) ): F (x, y g ) \u2212 F (x, y) \u2265 \u2206(y g , y) \u2200y = y g (2) However, the number of distinct labelings is exponential in the length of the sequence and it may not be possible to find a set of parameters which is able to satisfy all the constraints. In that case, the constraints are relaxed by introducing a nonnegative term, \u03be \u2265 0, in Eq. 2 to minimally satisfy all the constraints: F (x, y g ) \u2212 F (x, y) \u2265 \u2206(y g , y) \u2212 \u03be \u2200y = y g It is easy to see that the value of \u03be is set by the most violated of the constraints, with y * its corresponding labeling: \u03be = max y [\u2212F (x, y g ) + F (x, y) + \u2206(y g , y)] (3) y * = argmax y [F (x, y) + \u2206(y g , y)] (4) where we have omitted the first term in Eq. 4 since it does not depend on y. Note that since the search domain includes y g , and \u2206(y g , y g ) = 0, the above guarantees that \u03be \u2265 0. Eq. 3 is known as the structured hinge loss because of the interdependencies between the individual labels inside the scoring function and, possibly, the evaluation loss. In turn, the solution of Eq. 4 is known as the \"loss-augmented\" inference and is the crux of structured hinge loss minimisation. Given a training set, {x i , y i }, i = 1 . . . N , the training objective is therefore: w * = argmin w N i=1 \u03be i (w) (5) While the minimisation in Eq. 5 can be easily entertained by automated differentiation, the inference of the most-violating labelings must be performed externally with a dedicated algorithm. Scoring function The scoring function, F (x, y; w), has been implemented as a BiLSTM-CRF (Lample et al., 2016) , a popular NER model using a bidirectional LSTM as its feature layer and a CRF as its output layer. Its scoring function can be expressed as: F (x, y; w) = T t=2 w y t\u22121 ,yt + T t=1 f (y t ; w) (6) where w i,j are the transition weights for transitioning from label y t\u22121 = i to label y t = j, and f (y t ; w) denotes the score assigned to label y t by the BiLSTM layer. At its turn, the BiL-STM layer is organised as a bidirectional LSTM with trainable word and character embeddings as its inputs. At initialisation, the word embeddings can be assigned with either random or pre-trained values. At inference time, argmax y F (x, y; w) is provided by the Viterbi algorithm. For further details, please refer to (Lample et al., 2016) . The proposed multi-constraint structured hinge loss Rather than constraining the optimisation problem with an exponential number of constraints, the structured hinge loss minimisation only considers the constraint setting the value of the loss: \u03be = [\u2212F (x, y g ) + F (x, y * ) + \u2206(y g , y * )] (7) While such an approach makes the constrained minimisation feasible, we speculate that the addition of other constraints -either between the ground-truth labeling and other labelings, or between the other labelings themselves -may eventuate in a more performing model. To this aim, we have created a new set of labelings by arbitrarily introducing false positives in the ground-truth labelings of the training set. As false positives, we have decided to change the \"Outside\" label immediately preceding the first ground-truth entity of the training sentences into a \"B-ORG\" label. This is an altogether arbitrary change that creates mildly incorrect labelings: as such, we expect the scoring function to assign them scores lower than the corresponding ground truths, yet higher than more incorrect labelings. We note these new labelings as u i , i = 1 . . . N , reserving the subscript position for the sample index henceforth. Given these extra labelings, we propose three versions of a multi-constraint training loss: \u2022 Hinge-yu: in this loss, we impose an extra constraint between the altered groundtruth labeling, u i , and the remaining labelings. However, function \u2206(u i , y) cannot be used as margin since it expects to have a true labeling as its first argument. Therefore, following (Zhang and Piccardi, 2015) we set the margin to be (\u2206(y i , y) \u2212 \u2206(y i , u i )). The labeling returned by the loss-augmented inference with this margin is the same as in the standard case (y * i ) since the the second term in the margin (\u2206(y i , u i )) does not depend on y. \u2022 Double Hinge: in this loss, we instead impose an extra constraint between the groundtruth labeling, y i , and the altered ground truth, u i . As margin, we can naturally use \u2206(y i , u i ). \u2022 Discounted Margin: in this loss, we again impose an extra constraint between the altered ground-truth labeling, u i , and the remaining labelings. As margin, we use the regular loss function, \u2206(u i , y), but \"discounted\" by a small discount factor since u i is not an actual ground truth. As evaluation loss for the margin, we have simply used the Hamming loss, since it naturally decomposes over the individual tokens of its arguments and it allows us to easily touch up the standard Viterbi algorithm to provide the required loss-augmented inference. Extending the lossaugmented inference to other, more specialised evaluation measures such as the CoNLL and MUC scores (Nadeau and Sekine, 2007) could be the scope of future work. Experiments and results Experimental set-up We have carried out experiments over a challenging NER dataset, OntoNotes v5.0, which was first introduced in CoNLL 2012 as a shared task (Pradhan et al., 2012 (Pradhan et al., , 2013)) . This English dataset contains multi-token entities from 18 different categories, including amongst others, person, facility, NLL l N LL = \u2212 N i=1 log p(y i |x i ) Hinge Loss l Hinge = N i=1 [\u2212F (x i , y i ) + F (x i , y * i ) + \u2206(y i , y * i )] + y * i = argmax y F (x i , y) + \u2206(y i , y) Hinge-yu The experiments have been carried out using the DeLFT 1 implementation of the BiLSTM-CRF. In the experiments, the word embeddings have been initialised with a concatenation of fastText-300d 2 and ELMo-1024d 3 (DeLFT's default). All hyperparameters have also been left to their default values. Each training session has been run until convergence of the evaluation loss over the validation set or a maximum of 20 epochs. In the experiments, we have compared the following training objectives: 1) the NLL/cross entropy; 2) a standard structured hinge loss using the Hamming loss as margin (\"Hinge Loss\"), with no additional constraints; and 3-5) the three versions of the proposed multi-constraint structured hinge loss presented in Section 3.3. The discount factor, df , for the Discounted Margin approach has been chosen in range [0.85, 0.95] in 0.025 steps over the validation set. All the training objectives are displayed in Table 1 . l Hinge\u2212yu = N i=1 [\u2212F (x i , y i ) + F (x i , y * i ) + \u2206(y i , y * i )] + + N i=1 [\u2212F (x i , u i ) + F (x i , y * i ) + \u2206(y i , y * i ) \u2212 \u2206(y i , u i )] + y * i = argmax y F (x i , y) + \u2206(y i , y) Double Hinge l DoubleHinge = N i=1 [\u2212F (x i , y i ) + F (x i , y * i ) + \u2206(y i , y * i )] + + N i=1 [\u2212F (x i , y i ) + F (x i , u i ) + \u2206(y i , u i )] + y * i = argmax y F (x i , y) + \u2206(y i , y) Discounted Margin l DiscountedM argin = N i=1 [\u2212F (x i , y i ) + F (x i , y * i ) + \u2206(y i , y * i )] + + N i=1 [\u2212F (x i , u i ) + F (x i , y * i ) + df \u00d7 \u2206(u i , y * i )] + y * i = argmax y F (x i , y) + \u2206(y i , y) For evaluation, we have used the CoNLL score, an entity-oriented variant of the F 1 score which is the standard evaluation measure for NER (Nadeau and Sekine, 2007) . For every experiment, we have run three independent runs from different random seeds and reported their average score. In addition, for the most noteworthy pairwise comparisons, we have run one-tailed Welch's t-tests to test statistical significance (Hintze, 2019) . As shown in (Colas et al., 2019) , the Welch's t-test enjoys a good balance between Type I and Type II errors under a variety of assumptions for the underlying score distributions (beyond Gaussian), especially for small sample sizes. Results and analysis Table 2 shows the CoNLL scores achieved by the compared training objectives over the OntoNotes 5.0 test set as average of 3 independent runs. The table shows that even the standard structured hinge loss has achieved a higher score than the NLL (+0.27 percentage points). Even if the improvement is mild, the standard deviations over the three runs are small and the p-value from a onetailed Welch's t-test is < 0.05, showing that the improvement is statistically significant. In turn, all the versions of the proposed multi-constraint hinge loss have achieved higher scores than both the NLL and the standard structured hinge loss, with the Discounted Margin achieving the highest score. The improvement of the Discounted Margin over the NLL has been +0.62 percentage points, with a one-tailed Welch's t-test p-value < 0.01. While this improvement is still somehow limited, we wish to remark that it has leveraged only changes to the loss function in the code, and at a complete parity of model. Conclusion In this short paper, we have proposed a multiconstraint structured hinge loss to be used as training objective for a named-entity recognition model. The proposed loss enforces additional constraints with respect to the standard structured hinge loss with the aim of improving the test accuracy of the trained model. Experimental results over a challenging NER dataset (OntoNotes 5.0) have showed that the proposed loss has been able to achieve an improvement of 0.62 CoNLL score percentage points over the common negative loglikelihood. In the future, we aim to explore further combinations of constraints and margins, and possibly extend the proposed approach to other tasks.",
    "funding": {
        "defense": 0.0,
        "corporate": 0.0,
        "research agency": 0.0,
        "foundation": 3.128162811005808e-07,
        "none": 1.0
    },
    "reasoning": "Reasoning: The article does not mention any specific funding sources, including defense, corporate, research agencies, foundations, or any other type of financial support for the research conducted or for the writing of the paper.",
    "abstract": "The negative log-likelihood or cross entropy is the usual training objective of NLP models owing to its versatility and empirical performance. However, training objectives which directly target the performance measure used to evaluate the task have the potential to lead to higher empirical accuracy. For this reason, in this short paper we propose using a multi-constraint structured hinge loss as the training objective of a contemporary namedentity recognition (NER) model. Experimental results over the challenging OntoNotes 5.0 dataset have shown that the proposed objective has been able to achieve an improvement of 0.62 CoNLL score points at a complete parity of testing set-up.",
    "countries": [
        "Australia"
    ],
    "languages": [
        "English"
    ],
    "numcitedby": 0,
    "year": 2019,
    "month": "4--6 December",
    "title": "A multi-constraint structured hinge loss for named-entity recognition",
    "values": {
        "building on past work": "The negative log-likelihood or cross entropy is the usual training objective of NLP models owing to its versatility and empirical performance. However, training objectives which directly target the performance measure used to evaluate the task have the potential to lead to higher empirical accuracy. For this reason, in this short paper we propose using a multi-constraint structured hinge loss as the training objective of a contemporary namedentity recognition (NER) model. Experimental results over the challenging OntoNotes 5.0 dataset have shown that the proposed objective has been able to achieve an improvement of 0.62 CoNLL score points at a complete parity of testing set-up. This is due to a number of attractive properties of the NLL such as its smoothness and differentiability in large regions of the parameter space. However, this function is not exempt from shortcomings. To name two, 1) the NLL only rewards the probability of the ground-truth class and does not distinguish between the other classes, and 2) it does not impose explicit margins (or ratios) between the probability assigned to the ground-truth class and those assigned to the other classes. For this reason, other differentiable loss functions are regarded as appealing alternatives or complements to the NLL.",
        "novelty": "      The proposed loss enforces additional constraints with respect to the standard structured hinge loss with the aim of improving the test accuracy of the trained model. ",
        "performance": " The negative log-likelihood or cross entropy is the usual training objective of NLP models owing to its versatility and empirical performance.  For this reason, in this short paper we propose using a multi-constraint structured hinge loss as the training objective of a contemporary namedentity recognition (NER) model.  Experimental results over the challenging OntoNotes 5.0 dataset have shown that the proposed objective has been able to achieve an improvement of 0.62 CoNLL score points at a complete parity of testing set-up.  Choosing the most appropriate loss function for a particular task can play an important role in the performance of the trained models at test time and in-field.  However, this function is not exempt from shortcomings. To name two, 1) the NLL only rewards the probability of the ground-truth class and does not distinguish between the other classes, and 2) it does not impose explicit margins (or ratios) between the probability assigned to the ground-truth class and those assigned to the other classes.    Our main contribution is the introduction of additional constraints between specific labelings aimed at increasing the accuracy of the learned model.  Experimental results over a challenging NER dataset (OntoNotes 5.0, which is still far from accuracy saturation) show that the proposed approach has been able to achieve higher accuracy than both the NLL and a conventional structured hinge loss.  While this improvement is still somehow limited, we wish to remark that it has leveraged only changes to the loss function in the code, and at a complete parity of model."
    }
}