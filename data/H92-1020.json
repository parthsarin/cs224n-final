{
    "article": "We present an algorithm to adapt a n-gram language model to a document as it is dictated. The observed partial document is used to estimate a unigram distribution for the words that already occurred. Then, we find the closest ngram distribution to the static n.gram distribution (using the discrimination information distance measure) and that satisfies the marginal constraints derived from the document. The resulting minimum discrimination information model results in a perplexity of 208 instead of 290 for the static trigram model on a document of 321 words. INTRODUCTION Statistical n-gram language models are useful for speech recognition and language translation systems because they provide an a-priori probability of a word sequence; these language models improve the accuracy of recognition or translation by a significant amount. In the case of trigram (n = 3) and blgram (n = 2) language models, the probability of the next word conditioned on the previous words is estimated from a large corpus of text. The resulting static language models (SLM) have fixed probabilities that are independent of the document being predicted. To improve the language model (LM), one can adapt the probabilities of the language model to match the current document more closely. The partially dictated (in the case of speech recognition) document provides significant clues about what words are more llke]y to be used next. One expects many words to be bursty. For example, if in the early part of a document the word lax has been used then the probability that it wilt be used again in the same document is significantly *PAPER SUBMITTED TO THE ICASSP92 PROCEEDINGS. higher than if it had not occurred yet. In addition, if the words in the early part of a document suggest that the current document is from a particular subdomain, then we may expect other related words to occur at a higher rate than the static model may suggest. For example, the words \"inspection, fire, and insurance\" suggest an insurance report domain, and therefore increased probabilities to words such as \"stairwell and electricar' . Assume that from a partial document, denoted by h, we have an estimate of the unigram distribution pa(w I h) that a word w may be used in the remaining part of the document. We will denote pa(w I h) by d(w), keeping in mind that this dynamic unigram distribution is continuously updated as the document is dictated and is estimated for a subset of R words of the vocabulary. (Typically R is on the order of a document size of about a few hundred words as compared to a vocabulary size of 20,000 words.) In general, the dynamic unigram distribution will be different from the static marginal unigram distribution, denoted by p~(w). In this paper, we propose a method for adapt-]ng the language model so that its marginal unigram distribution matches the desired dynamic unigram distribution d(w). The proposed approach consists of finding the model that requires the least pertubation of the static model and satisfies the set of constraints that have been derived from the partially observed document. By least pertubation we mean that the new model is closest to the static model, p~, using the non-symmetric Kullback-Liebler distortion measure (also known as dlscrimination information, relative entropy, etc.). The minimum discrimination information (MDI) p* distribution minimizes: i over all p that satisfy a set of R linear constrailtts. In this paper, we consider marginal constraints of the form p(i) = d, iECr where we are summing over all events i in the set C~ that correspond to the r-th constraint and d, is the desired value (for r = 1, 2, ..., R). In our case, the events i correspond to bigrams, (nq, w2), and the desired value for the r-th constraint, d,, is the marginal unigram probability, d(w,), for a word w,. The idea of using a window of the previous N words, called a cache, to estimate dynamic frequencies for a word was proposed in [5] for the case of a tri-part-ofspeech model and in [6] for a bigram model. In [4] a trigram language was estimated from the cache and interpolated with the static trlgram model to yield about 20% lower perplexity and from 5% to 25% lower recognition error rate on documents ranging in length from 100 to 800 words. ALTERNATING MINIMIZATION Starting with an initial estimate of the factors, the following iterative algorithm is guaranteed to converge to the optimum distribution. At each iteration j, pick a constraint rj and adjust the corresponding factor so that the constraint is satisfied. In the case of marginal constraints, the update is: new = fold dr, frj ~rj pj-l(Crj ) where pJ-~(C,j) is the marginal of the previous estlmate and d~j is the desired marginal. This iteratlve algorithm cycles through the constraints repeatadly until convergence hence the name alternating (thru the constraints) minimization. It was proposed by Darroch and Ratcliff in [3] . A proof of convergence for linear constraints is given in [2] . MINIMUM DISCRIMINATION INFORMATION The discrimination information can be written as: D(p, ps) = --EPlogps + EPlogp (1) = Itp,(p)-H(p) k 0 (2) where Rps(p ) is the bit rate in transmitting source p with model Ps and H(p) is the entropy of source p. The MDI distribution p* satisfies the following Pythagorean inequality: D(p,p,) > D(p,p*) + D(p*,ps) for all distributions p in the set PR of distributions that satisfy the R constraints. So if we have an accurate estimate of the constraints then using the MDI distribution will result in a lower error by at least D(p*, p~). The'. MDI distribution is the Maximum Entropy (ME) distribution if the static model is the uniform distribution. Using Lagrange multipliers and differentiating with respect to pi the probability of the i-th event, we find that the optimum must have the form p~ = p,ifi~f~2...fln where the factors fir are 1 if event i is not in the constraint set C, or some other value .f, if event i belongs to constraint set C,. So the MDI distribution is specified by the 17 factors .f,, r = 1, 2, ..., R, that correspond to the R constraints, in addition to the original static model. 104 ME CACHE We have applied the above approach to adapting a bigram model; we call the resulting model the ME cache. Using a cache window of the previous N words, we estimate the desired unigram probability of all/:/words that have occurred in the cache by: d(w) = .\\de(w) where Ac is an adjustment factor taken to be the prob.ability that the next word is already in the cache and .fc is the observed frequency of a word in the cache. Since any event (wl, wu) participates in 2 constraints one for the left marginal d(wl) and the other for the right marginal d(w~) there are 2//-,t-1 constraint, a left and right marginal for each word in the cache and the overall normalization, the ME bigram cache model is given by: We require the left and right marginals to be equal to get a st~ttionary model. (Since all events participate in the normalization that factor is absorbed in the other two.) The iterations fall into two groups: those in which a left marginal is adjusted and those in which a right marginal is adjusted. In each of these iterations, we adjust two factors simultaneously: one for the desired unigram probability d(w) and the other so that the resulting ME model is a normalized distribution. The update for left marginals is pJ(wl, W2) : pJ-l(wl, W2)aj.~j where aj and sj are adjustments given by: -d(wj) 8j = --pj--l(wj, .) d(w\u00a2) aj = sjpj_l(wj, .) where pJ-l(wj, .) denotes the left marginal of the (j -1)-th estimate of the ME distribution and wj is the word that corresponds to the selected constraint at the j-th iteration. Similar equations can be derived for the updates for the right marginals. The process is started with p0(w,, = Note that the marginM pJ(w,.) can be computed by using R additions and multiplications. The algorithm requires order//2 operation to cycle thru all constraints once. R is typically few hundred compared to the vocabulary size V which is 20,000 in our case. We have found that about 3 to 5 iterations are sufficient to achieve convergence. EXPERIMENTAL RESULTS Using a cache window size of about 700 words, we estimated a desired unigram distribution and a corresponding ME bigram distribution with an MDI of about 2.2 bits (or 1.1 bits/word). Since the unigram distribution may not be exact, we do not expect to reduce our perplexity on the next sentence by a factor larger than 2.1 = 2 El. The actuM reduction was a factor of 1.5 = 2 o.62 on the next 93 words of the document. For a smMler cache size the discrepancy between the MDI and actual perplexity reduction is larger. To evaluate the ME cache model we compared it to the trigram cache model and the static trigram model. In all models we use linear interpolation between the dynamic and static components as: In 'Fable 1, we compare the static, the ME cache, and the trigram cache models on three documents. Both cache models improve on the static. The ME and trigram cache are fairly close as would be expected since they both have the same dynamic unigram distribution. The second experiment illustrates how they are different. We compared the ME cache and the trigram cache on 2 non-senslcal sentences made up from words that have occurred in the first sentence of a document. The 2 sentences are: Document \u2022 SI: the letter fire to to to \u2022 S2: building building building building Table 2 shows the perplexity of each sentence at 2 points in the document history: one after the first sentence (of length 33 words) is in the cache and the second after 10 sentences (203 words) are in the cache. We can see that the trigram cache can make some rare bigrams (wl, w~) more likely if both wx and w2 have already occurred due to a term of the form d(wt)d(w2) whereas the ME cache still has the factor p, (wl, w2) which will tend to keep a rare bigram somewhat ]ess probM)]e. This is particular]y pronounced for $2, where we expect d(building) to be quite accurate after 10 sentences, the ME cache penalizes the unlikely bigram by a factor of about 13 over the trigram cache. Sentence CONCLUSION The MDI approach to adapting a language model can result in significant perplexity reduction without aleakage in the bigram probability model. We expect this fact to be important in adapting to a new domain where the unigram distribution d(w) can be estimated from possibly tens of documents. We are currently pursuing such experiments.",
    "abstract": "We present an algorithm to adapt a n-gram language model to a document as it is dictated. The observed partial document is used to estimate a unigram distribution for the words that already occurred. Then, we find the closest ngram distribution to the static n.gram distribution (using the discrimination information distance measure) and that satisfies the marginal constraints derived from the document. The resulting minimum discrimination information model results in a perplexity of 208 instead of 290 for the static trigram model on a document of 321 words.",
    "countries": [
        "United States"
    ],
    "languages": [],
    "numcitedby": "116",
    "year": "1992",
    "month": "",
    "title": "Adaptive Language Modeling Using Minimum Discriminant Estimation"
}