{
    "article": "A wide range of applications, from social media to scientific literature analysis, involve graphs in which documents are connected by links. We introduce a topic model for link prediction based on the intuition that linked documents will tend to have similar topic distributions, integrating a max-margin learning criterion and lexical term weights in the loss function. We validate our approach on the tweets from 2,000 Sina Weibo users and evaluate our model's reconstruction of the social network. Introduction Many application areas for text analysis involve documents connected by links of one or more types-for example, analysis of scientific papers (citations, co-authorship), Web pages (hyperlinks), legislation (co-sponsorship, citations), and social media (followers, mentions, etc.) . In this paper we work within the widely used framework of topic modeling (Blei et al., 2003, LDA) to develop a model that is simple and intuitive, but which identifies high quality topics while also accurately predicting link structure. Our work here is inspired by the phenomenon of homophily, the tendency of people to associate with others who are like themselves (McPherson et al., 2001) . As manifested in social networks, the intuition is that people who are associated with one another are likely to discuss similar topics, and vice versa. The new topic model we propose therefore takes association links into account so that a document's topic distribution is influenced by the topic distributions of its neighbors. Specifically, we propose a joint model that uses link structure to define clusters (cliques) of documents and, following the intuition that documents in the same cluster are likely to have similar topic distributions, assigns each cluster its own separate Dirichlet prior over the cluster's topic distribution. This use of priors is consistent with previous work that has shown document-topic priors to be useful in encoding various types of prior knowledge and improving topic modeling performance (Mimno and McCallum, 2008) . We then use distributed representations to \"seed\" the topic representations before getting down to modeling the documents. Our joint objective function uses a discriminative, max-margin approach (Zhu et al., 2012; Zhu et al., 2014) to both model the contents of documents and produce good predictions of links; in addition, it improves prediction by including lexical terms in the decision function (Nguyen et al., 2013) . Our baseline for comparison is the Relational Topic Model (Chang and Blei, 2010, henceforth RTM) , which jointly captures topics and binary link indicators in a style similar to supervised LDA (McAuliffe and Blei, 2008, sLDA) , instead of modeling links alone, e.g., as in the Latent Multi-group Membership Graph model (Kim and Leskovec, 2012, LMMG) . We also compare our approach with Daum\u00e9 III (2009) , who uses document links to create a Markov random topic field (MRTF). Daum\u00e9 does not, however, look at link prediction, as his upstream model (Mimno and McCallum, 2008) only generates documents conditioned on links. In contrast, our downstream model allows the prediction of links, like RTM. Our model's primary contribution is in its novel combination of a straightforward joint modeling approach, max-margin learning, and exploitation of lexical information in both topic seeding and regression, yielding a simple but effective model for topic-informed discriminative link prediction. Like other topic models which treat binary values \"probabilistically\", our model can convert binary link indicators into non-zero weights, with potential application to improving models like Volkova et al. (2014) , who use neighbor relationships to improve prediction of user-level attributes. Our corpus is collected from Sina Weibo with three types of links between documents. We first conduct a reality check of our model against LDA and MRTF and then perform link prediction tasks. We demonstrate improvements in link prediction as measured by predictive link rank and provide both qualitative and quantitative perspectives on the improvements achieved by the model. Step 1: Identifying birds of a feather. Prior to the generative process, given a training set of documents and document-to-document links, we begin by identifying small clusters or cliques using strongly connected components, which automatically determines the number of clusters from the link graph. Intuitively, documents in the same clique are likely to have similar topic distributions. Discriminative Links from Topics Therefore, each of the L cliques l (the \"birds of a feather\" of our title) is assigned a separate Dirichlet prior \u03c0 l over K topics. Step 2a: Using seed words to improve topic quality. To improve topic quality, we identify seed words for the K topics using distributed lexical representations: the key idea is to complement the more global information captured in LDAstyle topics with representations based on local contextual information. We cluster the most frequent words' word2vec representations (Mikolov et al., 2013) into K word-clusters using the kmeans algorithm, based on the training corpus. 1  We then enforce a one-to-one association between these discovered word clusters and the K topics. For any word token w d,n whose word type is in cluster k, the associated topic assignment z d,n can only be k. To choose topic k's seed words, within its word-cluster we compute each word w k,i 's skip-gram transition probability sum S k,i to the other words as S k,i = N k j=1,j =i p(w k,j | w k,i ), (1) where N k denotes the number of words in topic k. We then select the three words with the highest sum of transition probabilities as the seed words for topic k. In the sampling process (Section 3), seed words are only assigned to their corresponding topics, similar to the use of hard constraints by Andrzejewski and Zhu (2009) . Steps 2b-3: Link regression parameters. Given two documents d and d , we want to predict whether they are linked by taking advantage of their topic patterns: the more similar two documents are, the more likely it is that they should be linked together. Like RTM, we will compute a regression in Step 5 using the topic distributions of d and d ; however, we follow Nguyen et al. ( 2013 ) by also including a document's word-level distribution as a regression input. 2 The regression value of document d and d is Step 4: Generating documents. Documents are generated as in LDA, where each document's topic distribution \u03b8 is drawn from the cluster's topic prior (a parametric analog to the HDP of Teh et al. (2006) ) and each word's topic assignment is drawn from the document's topic distribution (except for seed words, as described above). R d,d = \u03b7 T (z d \u2022 z d ) + \u03c4 T (w d \u2022 w d ), (2) where z d = 1 N d n z d, Step 5: Generating links. Our model is a \"downstream\" supervised topic model, i.e., the prediction of the observable variable (here, document links) is informed by the documents' topic distributions, as in sLDA (Blei and McAuliffe, 2007) . In contrast to Chang and Blei (2010) , who use a sigmoid as their link prediction function \u03a8, we instead use hinge loss: the probability \u03a8 that two documents d and d are linked is p(y d,d = 1 | z d , z d , w d , w d ) = exp(\u22122c max(0, \u03b6 d,d )), where c is the regularization parameter. In the hinge loss function, \u03b6 d,d is \u03b6 d,d = 1 \u2212 y d,d R d,d . (3) 3 Posterior Inference Sampling Topics. Following Polson and Scott (2011) , by introducing an auxiliary variable \u03bb d,d , we derive the conditional probability of a topic assignment p(z d,n = k | z \u2212d,n , w \u2212d,n , w d,n = v) \u221d N \u2212d,n k,v + \u03b2 N \u2212d,n k,\u2022 + V \u03b2 \u00d7 (N \u2212d,n d,k + \u03b1\u03c0 \u2212d,n l d ,k )\u00d7 d exp \u2212 (c\u03b6 d,d + \u03bb d,d ) 2 2\u03bb d,d , (4) where N k,v denotes the count of word v assigned to topic k; N d,k is the number of tokens in document d that are assigned to topic k. \u03c0 \u2212d,n l d ,k = d \u2208S(l d ) N \u2212d,n d ,k + \u03b1 d \u2208S(l d ) N \u2212d,n d ,\u2022 + K\u03b1 , (5) where S(l d ) denotes the cluster which contains document d (Step 1 in the generative process). 3 More details here and throughout this section appear in the supplementary materials. Optimizing topic and lexical regression parameters. While topic regression parameters \u03b7 and lexical regression parameters \u03c4 can be sampled (Zhu et al., 2014) , the associated covariance matrix is huge (approximately 12K \u00d7 12K in our experiments). Instead, we optimize these parameters using L-BFGS. Sampling auxiliary variables. The likelihood of auxiliary variables \u03bb follows a generalized inverse Gaussian distribution GIG(\u03bb d,d ; 1 2 , 1, c 2 \u03b6 2 d,d ). Thus we sample \u03bb \u22121 d,d from a an inverse Gaussian distribution p(\u03bb \u22121 d,d | z, w, \u03b7, \u03c4 ) = IG \u03bb \u22121 d,d ; 1 c|\u03b6 d,d | , 1 . (6) 4 Experimental Results Dataset We crawl data from Sina Weibo, the largest Chinese micro-blog platform. The dataset contains 2,000 randomly-selected verified users, each represented by a single document aggregating all the user's posts. We also crawl links between pairs of users when both are in our dataset. Links correspond to three types of interactions on Weibo: mentioning, retweeting and following. 4 Perplexity Results As an initial reality check, we first apply a simplified version of our model which only uses user interactions for topic modeling and does not predict links. This permits a direct comparison of our model's performance against LDA and Markov random topic fields (Daum\u00e9 III, 2009 , MRTF) by evaluating perplexity. We set \u03b1 = \u03b1 = 15 and run the models on 20 topics for all models in this and following sections. The results are the average values of five independent runs. Following Daum\u00e9, in each run, for each document, 80% of its tokens are randomly selected for training and the remaining 20% are for test. As the training corpus is generated randomly, seeding is not applied in this section. The results are given in Table 1 , where I-denotes that the model incorporates user interactions. The results confirm that our model outperforms both LDA and MRTF and that its use of user interactions holds promise. Link Prediction Results In this section, we apply our model on link prediction tasks and evaluate by predictive link rank (PLR). A document's PLR is the average rank, among all documents, of the documents to which it actually links. This means that lower values of PLR are better. Figure 2 breaks out the 5-fold cross validation results and the distinct extensions of RTM. 5 The results support the value in combining all three extensions using Lex-IS-MED-RTM, although for mentioning and retweeting, Lex-IS-MED-RTM and IS-RTM are quite close. Applying user interactions does not always produce improvements. This is because in our intrinsic evaluation, we assume that the links on the test set are not observable and cluster priors are 5 IS-denotes that the model incorporates user interactions and seed words, Lex-means that lexical terms were included in the link probability function (Equation 3 ), and MED-denotes max-margin learning (Zhu et al., 2014; Zhu et al., 2012) . Each type of link is applied separately; e.g., in Figure 2(a) results are based only on mentioning links, ignoring retweeting and following links. not applied. However, according to the training performance (extrinsic evaluations which we are still in progress), user interactions do benefit link prediction performance when links are partially available, e.g., suggesting more links based on observed links. In contrast, hinge loss and lexical term weights do not depend on metadata availability and generally produce improvements in link prediction performance. Illustrative Example We illustrate model behavior qualitatively by looking at two test set users, designated A and B. User A is a reporter who runs \"We Media\" on his account, sending news items to followers, and B is a consultant with a wide range of interests. Their tweets reveal that both are interested in social news-a topic emphasizing words like society, country, government, laws, leaders, political party, news, etc. Both often retweet news related to unfairness in society and local government scandals (government, police, leaders, party, policy, chief secretary). For example, User A retweeted a report that a person about to be executed was unable to take a photo with his family before his execution, writing I feel heartbroken. User B retweeted news that a mayor was fired and investigated because of a bribe; in his retweet, he expresses his dissatisfaction with what the mayor did when he was in power. In addition, User A follows new technology (smart phone, Apple, Samsung, software, hardware, etc.) and B is interested in food (snacks, noodles, wine, fish, etc.). As ground truth, there is a mentioning link from A to B; ) is an alternative to manual evaluations of topic quality (Chang et al., 2009) . In each topic, the top n words' average pointwise mutual information (PMI)-based on a reference corpus-serves as a measure of topic coherence. 7 Topic quality improves with user interactions and max-margin learning (Table 3 ). PMI drops when lexical terms are added to the link probability function, however. This is consistent with the role of lexical terms in the model; their purpose is to improve link prediction performance, not improve topic quality. Average Regression Value. One way to assess the quality of link prediction is to compare the scores of (ground-truth) linked documents to documents in general. In Table 3 , the Average Regression Values show this comparison as a ratio. The higher the ratio, the more linked document pairs differ from unlinked pairs, which means that linked documents are easier to distinguish. This ratio improves as RTM extensions are added, indicating better link modeling quality. In the SD/Avg row of Table 3 , we also compute a ratio of standard deviations to mean values. Ratios given by the models with hinge loss are lower than those not using hinge loss. This means that the regression values given by the models with hinge loss are more concentrated around the average value, suggesting that these models can better identify linked pairs, even though the ratio of linked pairs' average regression value to all pairs' average value is lower. Conclusions and Future Work We introduce a new topic model that takes advantage of document links, incorporating link information straightforwardly by deriving clusters from the link graph and assigning each cluster a separate Dirichlet prior. We also take advantage of locally-derived distributed representations to \"seed\" the model's latent topics in an informed way, and we integrate max-margin prediction and lexical regression to improve link prediction quality. Our quantitative results show improvements in predictive link rank, and our qualitative and quantitative analysis illustrate that the model's behavior is intuitively plausible. In future work, we plan to engage in further model analysis and comparison, to explore alterations to model structure, e.g. introducing hierarchical topic models, to use other clustering methods to obtain priors, and to explore the value of predicted links for downstream tasks such as friend recommendation (Pennacchiotti and Gurumurthy, 2011) and inference of user attributes (Volkova et al., 2014) . Acknowledgements We thank Hal Daum\u00e9 III for providing his code. This work was supported in part by NSF award 1211153. Boyd-Graber is supported by NSF Grants CCF-1409287, IIS-1320538, and NCSE-1422492. Any opinions, findings, conclusions, or recommendations expressed here are those of the authors and do not necessarily reflect the view of the sponsor."
}